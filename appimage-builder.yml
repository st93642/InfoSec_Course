# appimage-builder recipe for InfoSec Course Video Terminal
version: 1

AppDir:
  path: ./AppDir

  app_info:
    id: com.github.st93642.InfoSecCourse
    name: InfoSec Course
    icon: InfoSecCourse
    version: 1.0.0
    exec: InfoSecCourse.py
    exec_args: "$@"

  apt:
    arch: amd64
    sources:
      - sourceline: 'deb [arch=amd64] http://archive.ubuntu.com/ubuntu/ noble main restricted universe multiverse'
      - sourceline: 'deb [arch=amd64] http://archive.ubuntu.com/ubuntu/ noble-updates main restricted universe multiverse'
      - sourceline: 'deb [arch=amd64] http://archive.ubuntu.com/ubuntu/ noble-security main restricted universe multiverse'

    include:
      # Python and core dependencies
      - python3
      - python3-pip
      - python3-venv
      - python3-pyqt5
      - python3-pyqt5.qtmultimedia
      - python3-requests
      - python3-vlc

      # System libraries for PyQt5 and VLC
      - libqt5core5a
      - libqt5gui5
      - libqt5widgets5
      - libqt5multimedia5
      - libqt5multimediawidgets5
      - libvlc-bin
      - libvlccore9
      - vlc-plugin-base
      - libx11-6
      - libxcb1
      - libxext6
      - libgl1-mesa-glx
      - libglib2.0-0
      - libgstreamer1.0-0
      - libgstreamer-plugins-base1.0-0

      # Terminal and X11 dependencies
      - xterm
      - libxss1
      - libasound2
      - libpulse0

    exclude:
      - libc6-dev
      - libgcc-*-dev
      - linux-libc-dev

  files:
    include:
      # Application files
      - InfoSecCourse.py
      - InfoSecCourse.desktop
      - InfoSecCourse.png
      - main.py
      - controllers/**/*
      - models/**/*
      - services/**/*
      - ui/**/*
      - utils/**/*
      - requirements.txt
      - README.md

    exclude:
      - "**/__pycache__"
      - "**/*.pyc"
      - "**/.git"
      - "**/.pytest_cache"
      - "**/.coverage"
      - "**/tests"
      - "**/pytest.ini"
      - "**/run.sh"
      - "**/fetch_assets.py"
      - "**/appimage-builder.yml"
      - "**/appimage-builder.AppImage"

  runtime:
    env:
      # Set Python path to include the app directory
      PYTHONPATH: "$APPDIR/usr/lib/python3/dist-packages:$APPDIR/opt/InfoSecCourse"
      # VLC plugin path
      VLC_PLUGIN_PATH: "$APPDIR/usr/lib/x86_64-linux-gnu/vlc/plugins"
      # Qt platform plugin path
      QT_QPA_PLATFORM_PLUGIN_PATH: "$APPDIR/usr/lib/x86_64-linux-gnu/qt5/plugins/platforms"

AppImage:
  arch: x86_64
  update-information: None
  sign-key: None